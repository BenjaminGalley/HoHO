<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fast Keno | HoHoHo Bet</title>
<link rel="stylesheet" href="style.css">
<script src="script.js" defer></script>
<style>
body {margin:0; font-family: Arial, sans-serif; background:#fce4ec; color:#000;}
.top-bar {background:#ff5252; color:#fff; padding:10px 20px; display:flex; justify-content:space-between; align-items:center;}
.top-bar .logo {font-size:1.8em; font-weight:bold;}
.container {display:flex; flex-direction:column; align-items:center; padding:10px;}
#balancePanel {margin-top:10px; font-weight:bold;}
.keno-board {display:grid; grid-template-columns: repeat(10, 50px); grid-gap:5px; margin-top:20px;}
.keno-cell {width:50px; height:50px; background:#ffcdd2; display:flex; justify-content:center; align-items:center; border:1px solid #d50000; cursor:pointer; font-weight:bold; font-size:1em;}
.keno-cell.selected {background:#4caf50; color:#fff;}
#drawNumbers {margin-top:20px; display:flex; flex-wrap:wrap; gap:5px; justify-content:center;}
.draw-number {width:30px; height:30px; background:#ffeb3b; display:flex; justify-content:center; align-items:center; font-weight:bold; border-radius:50%; font-size:1em;}
#tickets {margin-top:20px; display:flex; overflow-x:auto; padding:5px; width:95%;}
.ticket {background:#fff; border:1px solid #ccc; border-radius:5px; margin-right:10px; padding:5px; min-width:120px; font-size:0.9em;}
.ticket-winner {background:#4caf50; color:#fff; font-weight:bold;}
.controls {margin-top:10px; display:flex; align-items:center; gap:10px;}
button {padding:6px 12px; font-size:1em; cursor:pointer;}
#betAmount {width:50px; text-align:center;}
#potentialWin {margin-left:10px; font-weight:bold;}
</style>
</head>
<body>
<div class="top-bar">
  <div class="logo">Fast Keno</div>
  <div id="balancePanel"></div>
</div>

<div class="container">
  <div class="keno-board"></div>
  
  <div class="controls">
    <button onclick="decreaseBet()">-</button>
    <input type="text" id="betAmount" value="2" readonly>
    <button onclick="increaseBet()">+</button>
    <button onclick="placeBet()">Bet</button>
    <span id="potentialWin">Potential Win: 0</span>
  </div>

  <div id="drawNumbers"></div>
  <div id="tickets"></div>
</div>

<script>
// =========================
// CONFIG & STATE
// =========================
const MAX_SELECTION = 10;
const MIN_BET = 2;
const drawInterval = 60000; // 60s
const reviewGap = 5000; // 5s
let selectedNumbers = [];
let tickets = [];
let betAmount = MIN_BET;
let drawNumbersArray = [];
let drawTimer;

// =========================
// INIT BOARD
// =========================
const board = document.querySelector(".keno-board");
function initBoard(){
  for(let i=1;i<=80;i++){
    const cell = document.createElement("div");
    cell.className="keno-cell";
    cell.innerText=i;
    cell.addEventListener("click",()=>toggleNumber(i,cell));
    board.appendChild(cell);
  }
}
initBoard();

// =========================
// TOGGLE NUMBERS
// =========================
function toggleNumber(num,cell){
  if(selectedNumbers.includes(num)){
    selectedNumbers = selectedNumbers.filter(n=>n!==num);
    cell.classList.remove("selected");
  } else {
    if(selectedNumbers.length>=MAX_SELECTION) return;
    selectedNumbers.push(num);
    cell.classList.add("selected");
  }
  updatePotentialWin();
}

// =========================
// BET CONTROLS
// =========================
function increaseBet(){ betAmount += 1; updateBetUI(); }
function decreaseBet(){ if(betAmount>MIN_BET){ betAmount -=1; updateBetUI(); } }
function updateBetUI(){ document.getElementById("betAmount").value=betAmount; updatePotentialWin(); }
function updatePotentialWin(){ document.getElementById("potentialWin").innerText=`Potential Win: ${betAmount*selectedNumbers.length} Birr`; }

// =========================
// PLACE BET
// =========================
function placeBet(){
  if(!user) return alert("Login first");
  if(selectedNumbers.length<2) return alert("Select at least 2 numbers");
  if(betAmount>balance) return alert("Insufficient balance");

  balance -= betAmount;
  localStorage.setItem(`balance_${user.id}`,balance);
  document.getElementById("balancePanel").innerText=`ID: ${user.id} | Balance: ${balance} Birr`;

  const ticket = {numbers:[...selectedNumbers],bet:betAmount,win:0,id:"T"+Date.now()};
  tickets.push(ticket);
  renderTickets();
  clearBoard();
}

// =========================
// CLEAR BOARD
// =========================
function clearBoard(){
  selectedNumbers=[];
  document.querySelectorAll(".keno-cell.selected").forEach(c=>c.classList.remove("selected"));
  updatePotentialWin();
}

// =========================
// RENDER TICKETS
// =========================
function renderTickets(){
  const container=document.getElementById("tickets");
  container.innerHTML="";
  tickets.forEach(t=>{
    const div=document.createElement("div");
    div.className="ticket";
    div.id=t.id;
    div.innerHTML=`<b>Ticket:</b> ${t.numbers.join(", ")}<br><b>Bet:</b> ${t.bet} Birr <b>Win:</b> ${t.win}`;
    container.appendChild(div);
  });
}

// =========================
// DRAW NUMBERS
// =========================
function drawKeno(){
  drawNumbersArray=[];
  while(drawNumbersArray.length<20){
    const n=Math.floor(Math.random()*80)+1;
    if(!drawNumbersArray.includes(n)) drawNumbersArray.push(n);
  }
  renderDraw();
  evaluateTickets();
  setTimeout(()=>{ startTimer(); }, reviewGap);
}

// =========================
// RENDER DRAW
// =========================
function renderDraw(){
  const drawPanel=document.getElementById("drawNumbers");
  drawPanel.innerHTML="";
  drawNumbersArray.forEach(n=>{
    const span=document.createElement("div");
    span.className="draw-number";
    span.innerText=n;
    drawPanel.appendChild(span);
  });
  markWinningNumbers();
}

// =========================
// MARK WINNING NUMBERS
// =========================
function markWinningNumbers(){
  tickets.forEach(t=>{
    t.win=0;
    const ticketDiv=document.getElementById(t.id);
    ticketDiv.querySelectorAll(".hit").forEach(el=>el.remove());
    t.numbers.forEach(num=>{
      if(drawNumbersArray.includes(num)){
        t.win+=betAmount;
        const hit=document.createElement("span");
        hit.className="hit";
        hit.innerText=num;
        ticketDiv.appendChild(hit);
      }
    });
    if(t.win>0) ticketDiv.classList.add("ticket-winner");
    else ticketDiv.classList.remove("ticket-winner");
    ticketDiv.innerHTML=`<b>Ticket:</b> ${t.numbers.join(", ")}<br><b>Bet:</b> ${t.bet} Birr <b>Win:</b> ${t.win}`;
  });
}

// =========================
// TIMER
// =========================
function startTimer(){
  clearInterval(drawTimer);
  let remaining=drawInterval/1000;
  drawTimer=setInterval(()=>{
    remaining--;
    if(remaining<=0){
      clearInterval(drawTimer);
      drawKeno();
    }
  },1000);
}

// =========================
// INIT
// =========================
startTimer();
</script>

</body>
</html>
