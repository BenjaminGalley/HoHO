<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Fast Keno | HoHoHo Bet</title>
<link rel="stylesheet" href="style.css">
<style>
body{margin:0;padding:0;font-family:sans-serif;background:#330000;color:#fff;display:flex;flex-direction:column;align-items:center}
.top-bar{display:flex;justify-content:space-between;align-items:center;padding:10px 20px;background:#551111;border-bottom:3px solid #ffcc33;width:100%;position:sticky;top:0;z-index:1000}
.top-bar .logo{font-size:22px;font-weight:bold}
.balance-panel{font-weight:bold;font-size:18px;color:#ffcc33}
.keno-container{display:flex;flex-direction:column;align-items:center;margin-top:20px}
.keno-table{display:grid;grid-template-columns:repeat(10,50px);grid-gap:5px;background:#ff4444;padding:10px;border-radius:10px}
.keno-cell{width:50px;height:50px;background:#fff;color:#000;display:flex;justify-content:center;align-items:center;border-radius:5px;font-weight:bold;cursor:pointer;transition:0.2s}
.keno-cell.selected{background:#00c853;color:#000}
.keno-cell.winner{background:#ffeb3b;color:#000;font-weight:bold}
.tickets-container{display:flex;overflow-x:auto;margin-top:10px;padding-bottom:10px}
.ticket{min-width:120px;background:#111;border:2px solid #ffcc33;border-radius:8px;margin-right:10px;padding:10px;font-weight:bold;color:#ffcc33}
.bet-panel{display:flex;justify-content:center;align-items:center;margin-top:10px}
.bet-panel button{margin:0 5px;padding:8px 15px;font-weight:bold;border-radius:6px;border:none;cursor:pointer}
.bet-amount{font-weight:bold;font-size:18px;margin:0 10px;width:60px;text-align:center}
.pop-numbers{display:flex;flex-wrap:wrap;justify-content:center;margin-top:10px}
.pop-numbers span{background:#ffd600;color:#000;font-weight:bold;margin:3px;padding:6px 8px;border-radius:5px;font-size:16px}
</style>
</head>
<body>

<div class="top-bar">
  <div class="logo">Fast Keno</div>
  <div class="balance-panel" id="balancePanel"></div>
</div>

<div class="keno-container">
  <div class="keno-table" id="kenoTable"></div>
  <div class="bet-panel">
    <button onclick="changeBet(-1)">-</button>
    <input type="number" id="betAmount" class="bet-amount" value="2" min="2" max="1000" readonly>
    <button onclick="changeBet(1)">+</button>
    <button class="button" onclick="placeBet()">Bet</button>
  </div>
  <div class="tickets-container" id="ticketsContainer"></div>
  <div class="pop-numbers" id="popNumbers"></div>
</div>

<script>
let user=JSON.parse(localStorage.getItem("user")||"null");
let balance=Number(localStorage.getItem("balance")||0);
let playerId=user?user.id:"GUEST";
const balancePanel=document.getElementById("balancePanel");
balancePanel.innerText=`ID: ${playerId} | Balance: ${balance} Birr`;

const kenoTable=document.getElementById("kenoTable");
const ticketsContainer=document.getElementById("ticketsContainer");
const popNumbers=document.getElementById("popNumbers");
let selectedNumbers=[];
let tickets=[];
let betAmount=2;
const maxNumbers=10;
const drawInterval=60000; // 60s
const reviewTime=5000; // 5s

// Build 80-number table
for(let i=1;i<=80;i++){
  const cell=document.createElement("div");
  cell.className="keno-cell";
  cell.innerText=i;
  cell.addEventListener("click",()=>selectNumber(cell,i));
  kenoTable.appendChild(cell);
}

// Select number
function selectNumber(cell,num){
  if(selectedNumbers.includes(num)){
    selectedNumbers=selectedNumbers.filter(n=>n!==num);
    cell.classList.remove("selected");
  } else {
    if(selectedNumbers.length<maxNumbers){
      selectedNumbers.push(num);
      cell.classList.add("selected");
    }
  }
  calculatePotential();
}

// Calculate potential win
function calculatePotential(){
  // Simple example: 2 birr per number matched
  const potential=document.getElementById("betAmount").value * selectedNumbers.length;
  // Display potential somewhere (optional)
}

// Change bet
function changeBet(delta){
  betAmount+=delta;
  if(betAmount<2) betAmount=2;
  document.getElementById("betAmount").value=betAmount;
}

// Place bet
function placeBet(){
  if(selectedNumbers.length<2) return alert("Select at least 2 numbers");
  if(balance<betAmount) return alert("Insufficient balance");
  balance-=betAmount;
  localStorage.setItem("balance",balance);
  balancePanel.innerText=`ID: ${playerId} | Balance: ${balance} Birr`;

  const ticket={numbers:[...selectedNumbers],bet:betAmount,id:Date.now()};
  tickets.push(ticket);
  renderTickets();
  selectedNumbers=[];
  document.querySelectorAll(".keno-cell.selected").forEach(c=>c.classList.remove("selected"));
}

// Render tickets
function renderTickets(){
  ticketsContainer.innerHTML="";
  tickets.forEach(t=>{
    const div=document.createElement("div");
    div.className="ticket";
    div.innerText=`Ticket ${t.id}\nNumbers: ${t.numbers.join(", ")}\nBet: ${t.bet} Birr`;
    ticketsContainer.appendChild(div);
  });
}

// Draw numbers
function drawNumbers(){
  const drawn=[];
  while(drawn.length<20){
    const n=Math.floor(Math.random()*80)+1;
    if(!drawn.includes(n)) drawn.push(n);
  }
  popNumbers.innerHTML="";
  let i=0;
  const interval=setInterval(()=>{
    if(i>=drawn.length){
      clearInterval(interval);
      reviewDraw(drawn);
      return;
    }
    const span=document.createElement("span");
    span.innerText=drawn[i];
    popNumbers.appendChild(span);
    markWinning(drawn[i]);
    i++;
  },300);
}

// Mark winning numbers on table and tickets
function markWinning(num){
  document.querySelectorAll(".keno-cell").forEach(c=>{
    if(Number(c.innerText)===num) c.classList.add("winner");
  });
  tickets.forEach(t=>{
    if(t.numbers.includes(num)){
      // Highlight ticket (optional)
    }
  });
}

// Review before next draw
function reviewDraw(drawn){
  // Calculate ticket wins
  tickets.forEach(t=>{
    let matchCount=t.numbers.filter(n=>drawn.includes(n)).length;
    let winAmount=matchCount * t.bet; // simple
    balance+=winAmount;
  });
  tickets=[];
  localStorage.setItem("balance",balance);
  balancePanel.innerText=`ID: ${playerId} | Balance: ${balance} Birr`;
  // Reset table
  document.querySelectorAll(".keno-cell").forEach(c=>c.classList.remove("winner"));
  setTimeout(()=>drawNumbers(),reviewTime);
}

// Start first draw after 5s
setTimeout(()=>drawNumbers(),reviewTime);
</script>
</body>
</html>
